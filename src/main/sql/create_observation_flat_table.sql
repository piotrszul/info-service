DROP TABLE IF EXISTS  observation_flat;
CREATE TABLE observation_flat(
    ssue_timestamp TIMESTAMP, 
    issue_time_local STRING, 
    -- period
    period_timestamp TIMESTAMP, 
    period_time_local STRING,
    -- station
    stn_bom_id STRING,
    stn_description STRING, 
    stn_forecast_district_id STRING,
    stn_lat FLOAT,
    stn_lon FLOAT,
    stn_name STRING,
    stn_tz STRING,
    stn_wmo_id STRING,
    -- elements
    air_temperature FLOAT, 
    apparent_temp FLOAT,
    cloud STRING,
    cloud_base_m INT,
    cloud_oktas INT,
    cloud_type_id STRING,
    delta_t FLOAT,
    dew_point FLOAT,
    gust_kmh INT,
    maximum_air_temperature FLOAT,
    maximum_gust_dir STRING,
    maximum_gust_kmh INT,
    maximum_gust_spd INT,
    minimum_air_temperature FLOAT,
    msl_pres FLOAT,
    pres FLOAT,
    qnh_pres FLOAT,
    rainfall FLOAT,
    rainfall_24hr FLOAT,
    rel_humidity INT,
    sea_height INT,
    swell_dir STRING,
    swell_height INT,
    swell_period INT,
    vis_km INT,
    weather STRING,
    wind_dir STRING,
    wind_dir_deg INT,
    wind_gust_spd INT,
    wind_spd INT,
    wind_spd_kmh INT
) 
STORED AS PARQUET;
